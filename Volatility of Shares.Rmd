---
# IMPORTANT: Change settings here, but DO NOT change the spacing.
# Remove comments and add values where applicable.
# The descriptions below should be self-explanatory

title: "Analysing the volatility of large, mid and small cap shares in South Africa"
#subtitle: "This will appear as Right Header"

documentclass: "elsarticle"

# --------- Thesis title (Optional - set to FALSE by default).
# You can move the details below around as you please.
Thesis_FP: TRUE
Entry1: "Analysing the volatility of large, mid and small cap shares in South Africa"
Entry2: "\\textbf{Joshua Strydom}" # textbf for bold
#Entry3: "A thesis submitted toward the degree of Doctor of Philosophy"
Uni_Logo: Tex/Stellenbosch.jpeg # Place a logo in the indicated location (from your root, e.g. defaults to ~/Tex/Logo.png) and uncomment this line. Leave uncommented for no image
Logo_width: 0.3 # If using a logo - use this to set width (size) of image
Entry4: "Stellenbosch University"
Entry5: January 2023
# Entry6: April 2020
# Entry7:
# Entry8:

# --------- Front Page
# Comment: ----- Follow this pattern for up to 5 authors
AddTitle: TRUE # Use FALSE when submitting to peer reviewed platform. This will remove author names.
Author1: "Joshua Strydom^[__Contributions:__  \\newline _The authors would like to thank no institution for money donated to this project. Thank you sincerely._]"  # First Author - note the thanks message displayed as an italic footnote of first page.
Ref1: "Stellenbosch University, Stellenbosch, South Africa" # First Author's Affiliation
Email1: "20718284\\@sun.ac.za" # First Author's Email address

#Author2: "John Smith"
#Ref2: "Some other Institution, Cape Town, South Africa"
#Email2: "John\\@gmail.com"
#CommonAffiliation_12: TRUE # If Author 1 and 2 have a common affiliation. Works with _13, _23, etc.

#Author3: "John Doe"
#Email3: "Joe\\@gmail.com"

#CorrespAuthor_1: TRUE  # If corresponding author is author 3, e.g., use CorrespAuthor_3: TRUE

# Comment out below to remove both. JEL Codes only given if keywords also given.
keywords: "Volatility \\sep ALSI \\sep Standard deviation" # Use \\sep to separate
JELCodes: "L250 \\sep L100"

# ----- Manage headers and footers:
#BottomLFooter: $Title$
#BottomCFooter:
#TopLHeader: \leftmark # Adds section name at topleft. Remove comment to add it.
BottomRFooter: "\\footnotesize Page \\thepage" # Add a '#' before this line to remove footer.
addtoprule: TRUE
addfootrule: TRUE               # Use if footers added. Add '#' to remove line.

# --------- page margins:
margin: 2.3 # Sides
bottom: 2 # bottom
top: 2.5 # Top
HardSet_layout: TRUE # Hard-set the spacing of words in your document. This will stop LaTeX squashing text to fit on pages, e.g.
# This is done by hard-setting the spacing dimensions. Set to FALSE if you want LaTeX to optimize this for your paper.

# --------- Line numbers
linenumbers: FALSE # Used when submitting to journal

# ---------- References settings:
# You can download cls format here: https://www.zotero.org/ - simply search for your institution. You can also edit and save cls formats here: https://editor.citationstyles.org/about/
# Hit download, store it in Tex/ folder, and change reference below - easy.
bibliography: Tex/ref.bib       # Do not edit: Keep this naming convention and location.
csl: Tex/harvard-stellenbosch-university.csl # referencing format used.
# By default, the bibliography only displays the cited references. If you want to change this, you can comment out one of the following:
#nocite: '@*' # Add all items in bibliography, whether cited or not
# nocite: |  # add specific references that aren't cited
#  @grinold2000
#  @Someoneelse2010

# ---------- General:
RemovePreprintSubmittedTo: TRUE  # Removes the 'preprint submitted to...' at bottom of titlepage
Journal: "Journal of Finance"   # Journal that the paper will be submitting to, if RemovePreprintSubmittedTo is set to TRUE.
toc: FALSE                       # Add a table of contents
numbersections: TRUE             # Should sections (and thus figures and tables) be numbered?
fontsize: 11pt                  # Set fontsize
linestretch: 1.2                # Set distance between lines.
link-citations: TRUE            # This creates dynamic links to the papers in reference list.

### Adding additional latex packages:
# header-includes:
#    - \usepackage{colortbl} # Add additional packages here.

output:
  pdf_document:
    keep_tex: TRUE
    template: Tex/TexDefault.txt
    fig_width: 3.5 # Adjust default figure sizes. This can also be done in the chunks of the text.
    fig_height: 3.5
#abstract: |
#  Abstract to be written here. The abstract should not be too long and should provide the reader with a good understanding what you are writing about. Academic papers are not like novels where you keep the reader in suspense. To be effective in getting others to read your paper, be as open and concise about your findings here as possible. Ideally, upon reading your abstract, the reader should feel he / she must read your paper in entirety.
---

<!-- First: Set your default preferences for chunk options: -->

<!-- If you want a chunk's code to be printed, set echo = TRUE. message = FALSE stops R printing ugly package loading details in your final paper too. I also suggest setting warning = FALSE and checking for warnings in R, else you might find ugly warnings in your paper. -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
# Note: Include = FALSE implies the code is executed, but not printed in your pdf.
# warning and message = FALSE implies ugly messages and warnings are removed from your pdf.
# These should be picked up when you execute the command chunks (code sections below) in your rmd, not printed in your paper!

# Lets load in example data, and see how this can be stored and later called from your 'data' folder.
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
library(quantmod)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(fmxdat)
library(data.table)
library(tbl2xts)
library(tidyr)
library(PerformanceAnalytics)
library(rvest)
library(corrplot)
library(ggpubr)
```

```{r Load data, include=FALSE}
Alsi <- readRDS("data/Alsi_Returns.rds")
Alsi <- as.data.frame(Alsi)
```

```{r Load functions, include=FALSE}
#Create functions that create the data frames for each size
contribution <- function(x) {
  index1 <- x[,c(1:3,7)] |> 
      mutate(Contribution = Return * J203) #All share index
  index1[is.na(index1)] = 0
  wide_index1 <- spread(index1[,c(1:2,5)], Tickers, Contribution)
  wide_index1[is.na(wide_index1)] = 0
  daily_contribution <- wide_index1 |> 
      mutate(Daily_return = select(wide_index1, 2:ncol(wide_index1)) |> rowSums(na.rm = TRUE)) #Sum of daily returns of each stock for index
  first <- daily_contribution[,1]
  last <- daily_contribution[,ncol(daily_contribution)]
  Total <- data.frame(first,last)
  colnames(Total)[1] <- "date"
  colnames(Total)[2] <- "Daily_return"
  return(Total)
} #Use output for rolling and daily functions

contributionmid <- function(x) {
  index1 <- x[,c(1:3,9)] |> 
      mutate(Contribution = Return * J201) #Mid cap index
  index1[is.na(index1)] = 0
  wide_index1 <- spread(index1[,c(1:2,5)], Tickers, Contribution)
  wide_index1[is.na(wide_index1)] = 0
  daily_contribution <- wide_index1 |> 
      mutate(J201Daily_return = select(wide_index1, 2:ncol(wide_index1)) |> rowSums(na.rm = TRUE)) #Sum of daily returns of each stock for index
  Total <- daily_contribution[,c(1,177)]
  return(Total)
} #Use output for rolling and daily functions

contributionsmall <- function(x) {
  index1 <- x[,c(1:3,10)] |> 
      mutate(Contribution = Return * J202) #Small cap index
  index1[is.na(index1)] = 0
  wide_index1 <- spread(index1[,c(1:2,5)], Tickers, Contribution)
  wide_index1[is.na(wide_index1)] = 0
  daily_contribution <- wide_index1 |> 
      mutate(J202Daily_return = select(wide_index1, 2:ncol(wide_index1)) |> rowSums(na.rm = TRUE)) #Sum of daily returns of each stock for index
  Total <- daily_contribution[,c(1,225)]
  return(Total)
}
#Use output for rolling and daily functions

daily_contri <- function(x){
    daily <- x |> 
        mutate(Cum_Ret = cumprod(1 + Daily_return))
    xts <- tbl_xts(daily)
    return(xts)
}

rolling_contri <- function(x){
    rolling <- x |> 
        gather(Ticker, Contribution, -date) |> 
        group_by(Ticker)
    xts <- tbl_xts(tblData = rolling, cols_to_xts = Contribution, spread_by = Ticker)
    return(xts)
}

rolling_SDcum <- function(x){
    rolling <- x |> #Use large_caps, mid_caps or small_caps
        mutate(YM = format(date, "%Y%B")) |> 
        arrange(date) |> 
        group_by(Tickers, YM) |> 
        filter(date == last(date)) |> 
        group_by(Tickers) |> 
        select(date, Tickers, Return) |> 
        mutate(RollSD = RcppRoll::roll_sd(1 + Return, 36, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(RollSD))
    return(rolling)
}
```

```{r Dataframes, include=FALSE}
# Wrote function to find daily returns for each index given the constituent shares. 
index <- function(x){
    index <- x
    index <- index[,-c(5:10)]
    index$Tickers <- gsub(" SJ|Equity","", index$Tickers)
    wide <- spread(index[,c(1,2,7)], Tickers, Contribution)
    #wide[is.na(wide)] = 0 #Made NAs equal to zero so that rowSums function would work
    Total <- wide |> 
      mutate(Contribution = select(wide, 2:ncol(wide)) |> rowSums(na.rm = TRUE)) #Sum of daily returns of each stock for index
    first <- Total[,1] #Kept the date column
    last <- Total[,ncol(Total)] #Kept the contribution column
    Final <- data.frame(first,last) #Merged the dateframes
    colnames(Final)[1] <- "date"
    colnames(Final)[2] <- "Daily_return"
    Cum <- Final |> 
        mutate(Cumulative_returns = cumprod(1 + Daily_return)) |>#Get cumulative returns for the index
        filter(Daily_return != 0) #Filtered out rows that did not contribute. 
    return(Cum)
}
J200 <- Alsi |> 
    filter(Index_Name == "Large_Caps") |> 
    mutate(Contribution = Return*J200)
l_caps <- index(J200)

J201 <- Alsi |> 
    filter(Index_Name == "Mid_Caps") |> 
    mutate(Contribution = Return*J201)
m_caps <- index(J201)
J202 <- Alsi |> 
    filter(Index_Name == "Small_Caps") |> 
    mutate(Contribution = Return*J202)
s_caps <- index(J202)
```

<!-- ############################## -->
<!-- # Start Writing here: -->
<!-- ############################## -->

# Introduction \label{Introduction}

In general, small cap stocks tend to have higher volatility than large cap stocks, and mid cap stocks tend to fall in between the two in terms of volatility. This is because small cap companies typically have less established business models and less predictable revenue streams, which can lead to greater fluctuations in their stock prices. On the other hand, large cap companies tend to have more established business models and more predictable revenue streams, which can lead to less volatility in their stock prices. In R, one can use the package 'PerformanceAnalytics' to calculate the volatility of different indexes. 


```{r Drawdowns, include=FALSE}
daily_contri <- function(x){
    xts <- tbl_xts(x)
    return(xts)
}
drawdown_large <- daily_contri(l_caps)
drawdown_mid <- daily_contri(m_caps)
drawdown_small <- daily_contri(s_caps)
```


# Index Analysis \label{Index}

The analysis of volatility is based on three indexes of the Johannesburg Securities Exchange (JSE). Data is attained by filtering out the FTSE All Share Index (ALSI). The large cap index is based on the FTSE/JSE Top 40 Index (J200), the mid cap index is based on the FTSE/JSE Mid Cap Index (J201) and the small cap index is based on the FTSE/JSE Small Cap Index (J202). The derived returns for each of the separate indexes are calculated as the product of a stocks daily return and the assigned weight in the respective index. For the large and small cap indexes, data from 2005 to 2022 is available. Unfortunately for the mid cap index, data is only available from 2016 onward.

<!-- The following is a code chunk. It must have its own unique name (after the r), or no name. After the comma follows commands for R which are self-explanatory. By default, the code and messages will not be printed in your pdf, just the output: -->

```{r Large cap shares, include=FALSE}
#large_caps <- Alsi |> 
#    filter(Index_Name == "Large_Caps")
#large_caps$Tickers <- gsub(" SJ|Equity","", large_caps$Tickers)
#large <- contribution(large_caps)
#daily_large <- daily_contri(large)
#colnames(daily_large)[1] <- "large_daily_return"
#rolling_large <- rolling_contri(large)
#rolling_large1 <- rolling_SDcum(large_caps) |> 
#    ggplot() +
#    geom_line(aes(x = date, y = RollSD, color = Tickers), alpha = 0.7, size = 1.25) +
#    labs(title = "Rolling 3 Year Annualized SD of various large cap stocks with differing start dates", subtitle = "", x = "", y = "Rolling 3 year Returns (Ann.)", caption = "Note:\nDistortions are not evident now.") + 
#    theme_fmx(title.size = ggpts(25), subtitle.size = ggpts(5), caption.size = ggpts(25), CustomCaption = T) +
#    theme(legend.position="none") #+
    #theme(text=element_text(family="Garamond", size=14))
```

## Drawdowns

A drawdown chart is used to illustrate the worst periods of time for a portfolio under analysis. The graphs are important for measuring the historical risk of an investment as they display the peak-to-trough decline in each of the indexes value.  A drawdown chart is essentially a measure of downside volatility. 

The large cap index in Figure\ref{Figure1} experienced its most drastic drawdown between 2008 and 2009 but most drawdowns were in the range of between 0 and -0.2. This is not surprising as the large cap index has a relatively large international exposure and hence, the aftermath of the Global Financial Crisis (GFC) would have been heavy hitting on the returns of the index. The next major drawdown occured in the period during the COVID-19 pandemic. The large cap index is thus highly reactive to times of economic crisis. This is no surprise. 

```{r Figure1,  warning =  FALSE, fig.align = 'center', fig.cap = "Large Cap drawdown chart \\label{Figure1}", fig.ext = 'png', fig.height = 3, fig.width = 6}
#finplot(rolling_large1, x.date.dist = "1 year", x.date.type = "%Y", x.vert = T, y.pct = T, y.pct_acc = 1)
chart.Drawdown(drawdown_large$Daily_return,main = "Drawdowns: Large Caps", 
               col = "steelblue")
```

It is unfortunate that data could not be obtained for the mid cap index for the full sample period. Most drawdowns for this short sample of the mid cap index were in the range of between 0 and -0.2. During the COVID-19 pandemic, the mid cap index responded very similarly to the large cap index. I attribute this common drawdown to the fact that the pandemic was not selective on which stocks within an index would be more or less affected. The pandemic was a global crisis and had nothing to do with an index's amount of international exposure. The GFC would have had more of an impact on an index with high international exposure compared to one with lower international exposure. 

```{r Figure2, warning =  FALSE, fig.align = 'center', fig.cap = "Mid Cap drawdown chart \\label{Figure2}", fig.height = 3, fig.width = 6, fig.ext = 'png'}
chart.Drawdown(drawdown_mid$Daily_return,main = "Drawdowns: Mid Caps", 
               col = "steelblue")
```

As illustrated in Figure \ref{Figure3}, the max drawdown for the small cap index occurred in the aftermath of the GFC. This drawdown was of a smaller magnitude and lasted for a shorter period when compared to the drawdown of the large cap index for the same period. The small cap index was not immune to the effects of the COVID-19 pandemic and so experienced a drawdown of a similar magnitude to both the large and mid cap indexes. 

```{r Figure3, warning =  FALSE, fig.align = 'center', fig.cap = "Small Cap drawdown chart \\label{Figure3}", fig.height = 3, fig.width = 6, fig.ext = 'png'}
chart.Drawdown(drawdown_small$Daily_return,main = "Drawdowns: Small Caps", 
               col = "steelblue")
#ggplot(daily_large, aes(x = Index, y = Cum_Ret)) + 
#    geom_line() +
#    theme_bw() +
#    labs(title = "Large cap shares in J203 cumulative Return", y = "Growth of R1 invested in 2005.")
```

## Sector weightings

```{r Weightings, include=FALSE}
#Weight comparision chart for sectors
J200sectors <- J200[,c(1,11,8)] |> 
    group_by(Sector) |> 
    rename(Weight = J200)
J201sectors <- J201[,c(1,11,9)] |> 
    group_by(Sector) |> 
    rename(Weight = J201)
J202sectors <- J202[,c(1,11,10)] |> 
    group_by(Sector) |> 
    rename(Weight = J202)
#J200weights <- aggregate(Weight~.,J200sectors,FUN=sum) |> 
#    group_by(date)
#names = c("Financials","Industrials","Resources","Property")
#ggplot(J200weights) +
#  geom_bar(aes(x=date,y=Weight,fill=factor(Sector, names)),
#           stat='identity') +
#    labs(x = NULL, y = NULL, title = "Sector Weight Comparison", fill = "Sector")

sector <- function(x){
    names = c("Financials","Industrials","Resources","Property")
    filtered <- x
    weights <- aggregate(Weight~., x,FUN=sum) |> 
        group_by(date) |> 
        ggplot() +
        geom_bar(aes(x=date, y=Weight, fill=factor(Sector, names)),
                 stat = 'identity', width = 1) +
        scale_y_continuous(labels = scales::percent_format(scale = 100)) +
        labs(x = NULL, y = NULL, title = "Sector Weighting", fill = "Sector") +
        theme_bw() +
        theme(legend.position="bottom")
        return(weights)
}
J200plot <- sector(J200sectors)

J201plot <- sector(J201sectors)

J202plot <- sector(J202sectors)

```

```{r sectors, include=FALSE}
#mid_caps <- Alsi |> 
#    filter(Index_Name == "Mid_Caps")
#mid_caps$Tickers <- gsub(" SJ|Equity","", mid_caps$Tickers)
#mid <- contribution(mid_caps)
#mid1 <- contributionmid(mid_caps)
#daily_mid <- daily_contri(mid)
#colnames(daily_mid)[1] <- "mid_daily_return"
#rolling_mid <- rolling_contri(mid)
#rolling_mid1 <- rolling_SDcum(mid_caps) |> 
#    ggplot() +
#    geom_line(aes(x = date, y = RollSD, color = Tickers), alpha = 0.7, size = 1.25) +
#    labs(title = "Rolling 3 Year Annualized SD of various mid cap stocks with differing start dates", subtitle = "", x = "", y = "Rolling 3 year Returns (Ann.)", caption = "Note:\nDistortions are not evident now.") + 
#    theme_fmx(title.size = ggpts(25), subtitle.size = ggpts(5), caption.size = ggpts(25), CustomCaption = T) +
#    theme(legend.position="none") #+
    #theme(text=element_text(family="Garamond", size=14))
sectors <- Alsi[,c(1,3,11)] |> 
    group_by(date, Sector) |> 
    summarise(Sum = sum(Return)) |> 
    ungroup() |> 
    filter(!is.na(Sector)) |> 
    na.omit() |> 
    spread(Sector, Sum)
summary(sectors)

StdDev(sectors$Industrials)
```

Table \ref{tab:Mean} below provides a depiction of the mean of daily returns for each sector over the entire period. The calculation was based solely on a stocks (within a certain sector) return and did not account for any weighting within an index. The 'Industrials' sector clearly generates, on average, the highest mean returns by a large magnitude. The 'Financials' sector generated the second highest mean daily returns while the 'Property' and 'Resources' sectors trailed far behind. The natural goal of an index would be to optimise its return profile. This would involve choosing a group of stocks that generate high returns but are not correlated (or have a low correlation). Hedging against downside returns could even be considered as important as searching for upside returns. 

\begin{table}[h]
\begin{center}
    \begin{tabular}{| c | c |}
    \hline
        Sector & Mean \\
        \hline
        Financials & 0.16530 \\
        Industrials & 1.342 \\
        Property & 0.009539 \\
        Resources & 0.07961 \\
        \hline
    \end{tabular}
    \caption{Mean daily returns}
    \label{tab:Mean}
\end{center}
\end{table}

As can be seen in \ref{Figure4}, the large cap index has historically neglected the 'Property' sector and has been dominated mostly by the 'Industrial' and 'Resource' sectors. In earlier periods of the sample (2005 to 2012) 'Resources' dominated 'Industrials' but the opposite became true in later periods. The 'Financials' sector seems to have maintained a relatively constant weighting in the large cap index. 
The weightings in the later portion of the period do not sum to one. This is the result of a few mid cap stocks being filtered out of the large cap index yet they formed part of the FTSE/JSE Top 40 Index.

```{r Figure4, warning =  FALSE, fig.align = 'center', fig.cap = "Sector weights for Large Cap index \\label{Figure4}", fig.height = 3, fig.width = 6, fig.ext = 'png'}
#finplot(rolling_mid1, x.date.dist = "1 year", x.date.type = "%Y", x.vert = T, y.pct = T, y.pct_acc = 1)
J200plot
```

The 'Industrials' sector also dominated the weighting of the mid cap index. Figure \ref{Figure5} displays a consistent domination of the 'Industrials' sector for the index. The 'Financial' sector was assigned the second highest weighting in the latter portion of the period at hand, surpassing the early dominance of the 'Resources' and 'Property' sector. The mid cap index assigned a noticeably greater weight to the 'Property' sector and a lower weight to the 'Resources' sector when compared to the large cap index for the latter portion of the full period under analysis. 

```{r Figure5, warning =  FALSE, fig.align = 'center', fig.cap = "Sector weights for Mid Cap index \\label{Figure5}", fig.height = 3, fig.width = 6, fig.ext = 'png'}
#chart.Drawdown(daily_mid$Daily_return,main = "Drawdowns: Mid caps in J203", 
#               col = "steelblue")
J201plot
```

When compared to the large and mid cap indexes, the small cap index placed the lowest weighting on the 'Financial' sector. The 'Property' sector in the small cap index was allocated the most weight out of all the indexes from around 2013 to 2022. The 'Resources' sector was not favoured and was assigned the smallest weighting in the small cap index for most of the period.  
The 'Industrials' sector once again dominated the weighting of the index, with approximately 50% of the small cap index being dominated by the sector for the full period. 

```{r Figure6, warning =  FALSE, fig.align = 'center', fig.cap = "Sector weights for Small Cap index \\label{Figure6}", fig.height = 3, fig.width = 6, fig.ext = 'png'}
#ggplot(daily_mid, aes(x = Index, y = Cum_Ret)) + 
#    geom_line() +
#    theme_bw() +
#    labs(title = "Mid cap shares in J203 cumulative Return", y = "Growth of R1 invested in 2005.")
J202plot
```

# Annualised returns \label{Returns}

The idea behind annualising returns is to be able to make direct comparisons of returns across different time periods. A rolling annualised return calculation was conducted in order to provide a means for actual performance comparison for the indexes at hand. As can be seen in Figure \ref{Figure7} below, the small cap index consistently outperforms both the large and mid cap indexes. An elementary analysis based on the figure of how large and small cap shares responded to the aftermath of the Global Financial Crisis of 2007/2008 yields interesting results. The small cap index seems to have had enjoyed increasingly positive returns subsequent to 2009 which may be due to the fact that the index had a low international exposure. This point is reaffirmed by Figures \ref{Figure1} and \ref{Figure3} in that the drawdown of the large cap index was more prolonged than the small cap drawdown even though the magnitude of drawdowns were similar. Although the returns for the large cap index never turned negative, the 'level of positivity' of returns diminished subsequent to the crisis. The annualised returns for the large and small indexes were most similar between 2013 and 2015. 

The mid cap index outperformed the large cap index from 2016 to approximately half way through 2020. Thereafter, the large cap index outperformed the mid cap index. Thus, a closer look at the pandemic period (2020 - 2022) seemed necessary. The particular point of interest is when the large and mid cap return lines intersected. Figures \ref{Figure1} and \ref{Figure2} provide insight on how the index compositions changed during this pandemic period. The large cap index assigned a greater weight to the 'Resources' sector, kept the weighting of the 'Industrials' sector relatively constant and down-weighted both the 'Financials' and the 'Property' sectors. The mid cap index , on the other hand, assigned a greater weight to the 'Financials' sector and down-weighted the other three sectors. The 'Financial' sector in South Africa absorbed heavy blows during and subsequent to the pandemic while the 'Resources' sector experienced a less dramatic downfall. This weighting discrepancy/mistake, as I see it, resulted in the unsatisfactory performance of the mid cap index. 
The small cap index assigned weights similarly to the large cap index with the exception of an increased weighting for the 'Property' sector as opposed to a decreased one. 

It is important to note that the small cap index consistently outperformed both the large and mid cap indexes throughout the period of analysis. 

```{r Small cap shares, include=FALSE}
#small_caps <- Alsi |> 
#    filter(Index_Name == "Small_Caps")
#small_caps$Tickers <- gsub(" SJ|Equity","", small_caps$Tickers)
#small <- contribution(small_caps)
#small1 <- contributionsmall(small_caps)
#daily_small <- daily_contri(small)
#colnames(daily_small)[1] <- "small_daily_return"
#rolling_small <- rolling_contri(small)
#roll <- rolling_SDcum(small_caps)
#rolling_small1 <- rolling_SDcum(small_caps) |> 
#    filter(RollSD < 0.4) |> 
#    ggplot() +
#    geom_line(aes(x = date, y = RollSD, color = Tickers), alpha = 0.7, size = 1.25) +
#    labs(title = "Rolling 3 Year Annualized SD of various small cap stocks with differing start dates", subtitle = "", x = "", y = "Rolling 3 year Returns (Ann.)", caption = "Note:\nDistortions are not evident now.") + 
#    theme_fmx(title.size = ggpts(25), subtitle.size = ggpts(5), caption.size = ggpts(25), CustomCaption = T) +
#    theme(legend.position="none") #+
    #theme(text=element_text(family="Garamond", size=14))
```

```{r Annual returns, include=FALSE}
#Rolling annualised returns of indices
roll_annualreturn <- function(x,y,z){
    large <- x[,-c(3)]
    colnames(large)[2] <- "Large_Cap"
    mid <- y[,-c(3)]
    colnames(mid)[2] <- "Mid_Cap"
    small <- z[,-c(3)]
    colnames(small)[2] <- "Small_Cap"
    joined <- list(large,mid,small) |> 
        reduce(full_join, by='date') |> 
        gather(Index, Return, -date) |> 
        arrange(date) |> 
        filter(!is.na(Return)) |> 
        mutate(YM = format(date, "%Y%B")) |> 
        arrange(date) |> 
        group_by(Index, YM) |> 
        filter(date == last(date))
    return(joined)
}
full_return <- roll_annualreturn(l_caps, m_caps, s_caps)
plotreturn <- full_return |> 
    group_by(Index) |> 
    mutate(RollRets = RcppRoll::roll_prod(1 + Return, 36, fill = NA, align = "right")^(12/36) - 1) |> 
    group_by(date) |> 
    filter(any(!is.na(RollRets))) |> 
    ungroup() |> 
    ggplot() +
    geom_line(aes(date, RollRets, color = Index), alpha = 0.7, size = 1.25) + 
    labs(title = "Rolling 3 Year Annualized Returns with differing start dates", 
    subtitle = "Large, Mid and Small cap Indexes", x = "", y = "Rolling 3 year Returns (Ann.)", 
    caption = "Note:\nDistortions are not evident now.") + theme_fmx(title.size = ggpts(30), 
    subtitle.size = ggpts(20), caption.size = ggpts(25), CustomCaption = T) + 
    fmx_cols()

```

```{r Figure7, warning =  FALSE, fig.align = 'center', fig.cap = "Rolling Annualised Returns of the Indexes \\label{Figure7}", fig.height = 5, fig.width = 6, fig.ext = 'png'}
finplot(plotreturn, x.date.dist = "1 year", x.date.type = "%Y", x.vert = T, y.pct = T, y.pct_acc = 1)
#finplot(rolling_small1, x.date.dist = "1 year", x.date.type = "%Y", x.vert = T, y.pct = T, y.pct_acc = 1)
```

```{r ret compare, include=FALSE}
b <- full_return |> 
    group_by(Index) |> 
    mutate(RollRets = RcppRoll::roll_prod(1 + Return, 12, fill = NA, align = "right")^(12/12) - 1) |> 
    group_by(date) |> 
    filter(any(!is.na(RollRets))) |> 
    ungroup() 
c <- b[-c(1:146),-c(3,4)] |> 
    spread(Index, RollRets)
return_density <- full_return[,-4] |>
    spread(Index, Return)
#return_density[-c(1:84),c(1,2)]
return_density_large <- ggplot(c[,c(1,2)], aes(x = Large_Cap)) +
    geom_density(color = "darkred", fill = "red") +
    geom_vline(aes(xintercept = mean(Large_Cap)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(-0.05, 0.1), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")

mid_density <- c[,c(1,3)] |> 
    na.omit()
return_density_mid <- ggplot(mid_density, aes(x = Mid_Cap)) +
    geom_density(color = "darkblue", fill = "lightblue") +
    geom_vline(aes(xintercept = mean(Mid_Cap)), 
             linetype = "dashed", size = 0.6, na.rm = FALSE) +
    coord_flip() +
    scale_x_continuous(limits = c(-0.05, 0.1), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")
#return_density[-c(1:84),c(1,4)]
return_density_small <- ggplot(c[,c(1,4)], aes(x = Small_Cap)) +
    geom_density(color = "darkgreen", fill = "lightgreen") +
    geom_vline(aes(xintercept = mean(Small_Cap)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(-0.05, 0.1), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")
```

```{r Figure8, warning =  FALSE, fig.align = 'center', fig.cap = "Rolling 12-Month Returns Comparison (past 10 Years) \\label{Figure8}", fig.height = 4, fig.width = 6, fig.ext = 'png'}
retplot <- ggarrange(return_density_large, return_density_mid, return_density_small + rremove("x.text"), 
          labels = c("Large Cap", "Mid Cap", "Small Cap"), align = "h", common.legend = TRUE, font.label = list(size = 10, color = "black"),
          ncol = 3, nrow = 1)
annotate_figure(retplot, top = text_grob("Rolling 12-Month Return Comparison (past 10 Years)", 
               color = "black", face = "bold", size = 11))
```

Both the Mid- and Small Cap indexes provide high potential upside returns. The horizontal lines running through each graph in Figure \ref{Figure8} represent the respective means of the rolling 12-month returns over the past 10 years. The Small Cap Index's mean return is significantly higher than both the Mid Cap Index and Large Cap Index mean returns. Although the Mid Cap Index mean return is below the 0-line, most returns are distributed above the 0-line. There is thus a higher likelihood for upside returns than downside ones. 

The return distribution of the Small Cap Index, in particular, is significantly more skewed to positive returns than the other indexes. It provides the greatest potential for upside gains.

# Rolling Standard deviation  \label{Standard deviation}

```{r Join, include=FALSE}
ljoin <- l_caps[,c(1,2)]
colnames(ljoin)[2] <- "large_dailyreturn"
mjoin <- m_caps[,c(1,2)]
colnames(mjoin)[2] <- "mid_dailyreturn"
sjoin <- s_caps[,c(1,2)]
colnames(sjoin)[2] <- "small_dailyreturn"
#join <- list(ljoin, mjoin, sjoin) |>
#    reduce(full_join, by='date') |> 
#    gather(Index, Return, -date) |> 
#    mutate(YM = format(date, "%Y%B")) |> 
#    arrange(date) |> 
#    group_by(Index, YM) |> 
#    filter(date == last(date)) |> 
#    group_by(Index) |> 
#    select(date, Index, Return) |> 
#    mutate(RollSD = RcppRoll::roll_sd(1 + Return, 36, fill = NA, align = "right") * sqrt(12)) |> 
#    filter(!is.na(RollSD)) |> 
#    ggplot() +
#    geom_line(aes(x = date, y = RollSD, color = Index), alpha = 0.7, size = 1.25) +
#    labs(title = "Illustration of Rolling 3 Year Annualized SD of various Indices with differing start dates", subtitle = "", x = "", y = "Rolling 3 year Returns (Ann.)", caption = "Note:\nDistortions are not evident now.") + 
#    theme_fmx(title.size = ggpts(25), subtitle.size = ggpts(5), caption.size = ggpts(25), CustomCaption = T) #+
    #theme(text=element_text(family="Garamond", size=14))

roll_SD <- function(x,y,z){
    large <- x |>
        mutate(Large_Cap = RcppRoll::roll_sd(1 + Daily_return, 36, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(Large_Cap))
    l <- large[,c(1,4)]
    mid <- y |> 
        mutate(Mid_Cap = RcppRoll::roll_sd(1 + Daily_return, 36, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(Mid_Cap))
    m <- mid[,c(1,4)]
    small <- z |> 
        mutate(Small_Cap = RcppRoll::roll_sd(1 + Daily_return, 36, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(Small_Cap))
    s <- small[,c(1,4)]
    joined <- list(l,m,s) |> 
        reduce(full_join, by='date') |> 
        gather(Index, SD, -date) |> 
        arrange(date)
    return(joined)
}
full_SD <- roll_SD(l_caps, m_caps, s_caps) |> 
    ggplot() +
        geom_line(aes(x = date, y = SD, color = Index), alpha = 0.7, size = 1) +
        labs(title = "Rolling 3 Year Annualized SD with differing starting dates", subtitle = "Large, Mid and Small cap Indexes", x = "", y = "Rolling 3 year Returns (Ann.)", caption = "Note:\nDistortions are not evident now.") + 
        theme_fmx(title.size = ggpts(30), subtitle.size = ggpts(20), caption.size = ggpts(25), CustomCaption = T) +
    scale_y_continuous(labels = scales::percent_format(scale = 100)) +
    theme(legend.position = "bottom") +
    fmx_cols()
```

```{r Figure9, warning =  FALSE, fig.align = 'center', fig.cap = "Rolling Annualised Standard Deviation of the Indexes \\label{Figure9}", fig.height = 5, fig.width = 6, fig.ext = 'png'}
finplot(full_SD, x.date.dist = "1 year", x.date.type = "%Y", x.vert = T, 
    y.pct = T, y.pct_acc = 1)
#finplot(join, x.date.dist = "1 year", x.date.type = "%Y", x.vert = T, y.pct = T, y.pct_acc = 1)
```

```{r sd compare, include=FALSE}
roll_SD_1 <- function(x,y,z,d){
    full <- d |> 
        group_by(Index) |> 
        select(date, Index, Return) |> 
        mutate(RollSD = RcppRoll::roll_sd(1 + Return, 12, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(RollSD))
    large <- x |>
        mutate(YM = format(date, "%Y%B")) |> 
        arrange(date) |> 
        group_by(large_dailyreturn, YM) |>  
        filter(date == last(date)) |> 
        group_by(Tickers) |> 
        mutate(Large_Cap = RcppRoll::roll_sd(1 + Daily_return, 12, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(Large_Cap))
    l <- large[,c(1,4)]
    mid <- y |> 
        mutate(Mid_Cap = RcppRoll::roll_sd(1 + Daily_return, 12, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(Mid_Cap))
    m <- mid[,c(1,4)]
    small <- z |> 
        mutate(Small_Cap = RcppRoll::roll_sd(1 + Daily_return, 12, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(Small_Cap))
    s <- small[,c(1,4)]
    joined <- list(l,m,s) |> 
        reduce(full_join, by='date') |> 
        gather(Index, SD, -date) |> 
        arrange(date)
    return(full)
}

#vol_returns <- list(ljoin, mjoin, sjoin) |>
#    reduce(full_join, by='date') |> 
#    rename(Large_Cap = large_dailyreturn) |> 
#    rename(Mid_Cap = mid_dailyreturn) |> 
#    rename(Small_Cap = small_dailyreturn) |> 
#    gather(Index, SD, -date) |> 
#    arrange(date) |> 
#    filter(!is.na(SD)) |> 
#    mutate(YM = format(date, "%Y%B")) |> 
#    arrange(date) |> 
#    group_by(Index, YM) |> 
#    filter(date == last(date))

full <- full_return |> 
        group_by(Index) |> 
        select(date, Index, Return) |> 
        mutate(RollSD = RcppRoll::roll_sd(1 + Return, 12, fill = NA, align = "right") * sqrt(12)) |> 
        filter(!is.na(RollSD))
SD_density <- full[,-3] |>
    spread(Index, RollSD)

#SD <- roll_SD_1(l_caps, m_caps, s_caps) |> 
#    arrange(date) |> 
#    filter(!is.na(SD)) |> 
#    mutate(YM = format(date, "%Y%B")) |> 
#    arrange(date) |> 
#    group_by(Index, YM) |> 
#    filter(date == last(date))
#SD_density <- SD[,-4] |>
#    spread(Index, SD)

sd_density_large <- ggplot(SD_density[-c(1:73),c(1,2)], aes(x = Large_Cap)) +
    geom_density(color = "darkred", fill = "red") +
    geom_vline(aes(xintercept = mean(Large_Cap)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(0.01, 0.04),labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")

sd_mid <- SD_density[,c(1,3)] |> 
    na.omit()
sd_density_mid <- ggplot(sd_mid, aes(x = Mid_Cap)) +
    geom_density(color = "darkblue", fill = "lightblue") +
    geom_vline(aes(xintercept = mean(Mid_Cap)), 
             linetype = "dashed", size = 0.6, na.rm = FALSE) +
    coord_flip() +
    scale_x_continuous(limits = c(0.01, 0.04), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")

sd_density_small <- ggplot(SD_density[-c(1:73),c(1,4)], aes(x = Small_Cap)) +
    geom_density(color = "darkgreen", fill = "lightgreen") +
    geom_vline(aes(xintercept = mean(Small_Cap)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(0.01, 0.04), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")
```

```{r Figure10, warning =  FALSE, fig.align = 'center', fig.cap = "Rolling 12-month Risk Comparison (past 10 Years) \\label{Figure10}", fig.height = 4, fig.width = 6, fig.ext = 'png'}
sdplot <- ggarrange(sd_density_large, sd_density_mid, sd_density_small + rremove("x.text"), 
          labels = c("Large Cap", "Mid Cap", "Small Cap"), font.label = list(size = 10, color = "black"),
          ncol = 3, nrow = 1)
annotate_figure(sdplot, top = text_grob("Rolling 12-Month Risk Comparison (past 10 Years)", 
               color = "black", face = "bold", size = 11))
```

In addition to providing us with increased diversification, the Mid- and Small-caps included in the CAPI also give us high potential upside returns.

```{r STD, include=FALSE}
largevol <- StdDev(l_caps$Daily_return)
midvol <- StdDev(m_caps$Daily_return)
smallvol <- StdDev(s_caps$Daily_return)

cat("Large volatility: ", largevol, "\n")
cat("Mid volatility: ", midvol, "\n")
cat("Small volatility: ", smallvol)
```

\begin{table}[h]
\begin{center}
    \begin{tabular}{| c | c |}
    \hline
         & Standard deviation \\
        \hline
        Large cap & 0.01298498 \\
        Mid cap & 0.01039368 \\
        Small cap & 0.00801369 \\
        \hline
    \end{tabular}
    \caption{Standard deviation}
    \label{tab:SD}
\end{center}
\end{table}

Figures \ref{Figure1}  and \ref{Figure2}


<!-- :::::: {.columns data-latex="[T]"} -->
<!-- ::: {.column data-latex="{0.7\textwidth}"} -->
<!-- ```{r, echo=FALSE, fig.width=4, fig.height=4} -->
<!-- par(mar = c(4, 4, .2, .1)) -->
<!-- plot(cars, pch = 19) -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: {.column data-latex="{0.05\textwidth}"} -->
<!-- \ -->
<!-- ::: -->
<!-- ::: {.column data-latex="{0.2\textwidth}"} -->
<!-- \scriptsize -->

<!-- ## Data {-} -->
<!-- The figure on the left-hand side shows the `cars` data. -->

<!-- Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do -->
<!-- eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut -->
<!-- enim ad minim veniam, quis nostrud exercitation ullamco laboris -->
<!-- nisi ut aliquip ex ea commodo consequat. -->
<!-- ::: -->
<!-- :::::: -->

```{r vol,include=FALSE}
vol_returns <- list(ljoin, mjoin, sjoin) |>
    reduce(full_join, by='date') #|> 
#    tbl_xts()
#VolatilitySkewness(vol_returns, MAR = 0, stat = c("volatility"))
```

\begin{table}[h]
\begin{center}
    \begin{tabular}{| c | c | c | c |}
    \hline
         & Large cap & Mid cap & Small cap \\
        \hline
        Volatility skewness & 1.069731 & 0.9739739 & 1.379238 \\
        \hline
    \end{tabular}
    \caption{Volatility skewness}
    \label{tab:VS}
\end{center}
\end{table}

The upside/downside ratio is often used to gauge overbought and oversold conditions in the market. Low values can indicate that the market is reaching oversold levels, while high values can indicate that the market is becoming overbought.

# Correlation \label{Correlation}

```{r Correlation, include=FALSE}
correlationreturn <- function(x){
    index <- x
    index <- index[,-c(5:10)]
    index$Tickers <- gsub(" SJ|Equity","", index$Tickers)
    Total <- index |> 
        mutate(Contribution = coalesce(Contribution, 0)) |> 
        group_by(Tickers) |> 
        mutate(Cumulative_contribution = cumprod(1 + Contribution))
    Final <- Total[,c(1,2,3)]
    wide <- spread(Final, Tickers, Return)
    wide1 <- as.data.frame(wide)
    wide2 <- wide1[-c(1:1750),]
    #wide1[is.na(wide1)] = 0 #Made NAs equal to zero so that rowSums function would work
    xts <- wide2[,c(2:86)] |> 
        xts(order.by = as.Date(wide2[ , 1], "%Y-%m-%d"))
    y <- rollapply(xts, width=365, cor, fill = NA, by.column=FALSE)
    paste_ <- function(...) paste(..., sep = "_")
    names_mat <- do.call("outer", list(names(xts), names(xts), paste_))
    names(y) <- names_mat
    #y$Average_correlation <- rowMeans(y, na.rm=TRUE)
    e <- y |> 
        xts_tbl()
    f <- rbind(e, sapply(e, function(x) if(is.numeric(x)) mean(x, na.rm = TRUE) else ""))
    last <- f[nrow(f),]
    long <- last |> 
        gather(Stocks, Correlation, -date)
    long1 <- long[,-1]
    long2 <- arrange(long1, Correlation)
    long3 <- long2[!duplicated(long2$Correlation), ]
    long3$Correlation <- as.numeric(as.character(long3$Correlation))
    #long4 <- long3[!is.nan(long3)] |> 
    #    filter(long3$Correlation != 1)
    #long3 = as.numeric(long2[,2]) 
    return(long3)
}
large_corr <- correlationreturn(J200)
large_corr1 <- large_corr[-c(1493:1494),]
plot_largecorr <- ggplot(large_corr1, aes(x = Correlation)) +
    geom_density(color="darkred", fill="red") +
    geom_vline(aes(xintercept = mean(Correlation)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(0, 0.5), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")
#plot_largecorr

mid_corr <- correlationreturn(J201)
mid_corr1 <- mid_corr[-c(1044:1045),]
plot_midcorr <- ggplot(mid_corr1, aes(x = Correlation)) +
    geom_density(color="darkblue", fill="lightblue") +
    geom_vline(aes(xintercept = mean(Correlation)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(0, 0.5), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")
#plot_midcorr

small_corr <- correlationreturn(J202)
small_corr1 <- small_corr[-c(721:722),]
plot_smallcorr <- ggplot(small_corr1, aes(x = Correlation)) +
    geom_density(color="darkgreen", fill="lightgreen") +
    geom_vline(aes(xintercept = mean(Correlation)), 
             linetype = "dashed", size = 0.6) +
    coord_flip() +
    scale_x_continuous(limits = c(0, 0.5), labels = scales::percent_format(scale = 100)) +
    theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank()) +
    theme(legend.position="none")
#plot_smallcorr
```

```{r Figure11, warning =  FALSE, fig.align = 'center', fig.cap = "Rolling Correlation Comparison of the Indexes \\label{Figure11}", fig.height = 4, fig.width = 6, fig.ext = 'png'}
corrplot <- ggarrange(plot_largecorr, plot_midcorr, plot_smallcorr + rremove("x.text"), 
          labels = c("Large Cap", "Mid Cap", "Small Cap"), font.label = list(size = 10, color = "black"),
          ncol = 3, nrow = 1)
annotate_figure(corrplot, top = text_grob("Rolling 12-Month Correlation Comparison (past 10 Years)", 
               color = "black", face = "bold", size = 11))
```


\hfill

<!-- hfill can be used to create a space, like here between text and table. -->

# Conclusion \label{Conclusion}

I hope you find this template useful. Remember, stackoverflow is your friend - use it to find answers to questions. Feel free to write me a mail if you have any questions regarding the use of this package. To cite this package, simply type citation("Texevier") in Rstudio to get the citation for @Texevier (Note that uncited references in your bibtex file will not be included in References).

<!-- Make title of bibliography here: -->
<!-- \newpage -->

\newpage

# References {-}

<div id="refs"></div>


# Appendix {-}

## Appendix A {-}

Some appendix information here

## Appendix B {-}

